{"ast":null,"code":"import _objectSpread from \"C:\\\\prog\\\\eleksPractice\\\\moviesapp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"C:\\\\prog\\\\eleksPractice\\\\moviesapp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\prog\\\\eleksPractice\\\\moviesapp\\\\src\\\\components\\\\Catalog.js\";\nimport debounce from 'lodash/debounce';\nimport React, { useEffect, useState } from 'react';\nimport API from '../API';\nimport Filters from './Filters';\nimport TextField from '@material-ui/core/TextField';\nimport Select from '@material-ui/core/Select';\nimport ListItem from './ListItem'; // const TRENDING = 'trending';\n// const POPULAR = 'popular';\n// const TOP = 'top';\n// const REQUEST_MAP = {\n//   [TRENDING]: API.getTrending,\n//   [POPULAR]: API.getPopular,\n//   [TOP]: API.getTopRated\n// }\n// function Catalog(props) {\n//   const [tempSearchQuery, setTempSearchQuery] = useState('');\n//   const [data, setData] = useState([]);\n//   const [settings, setSettings] = useState({\n//     sorting: localStorage.getItem('sorting') || 'trending',\n//     page: localStorage.getItem('page') || 1,\n//     searchQuery: ''\n//   });\n//   useEffect((_prevProps, _prevState) => {\n//     localStorage.setItem('page', settings.page);\n//     fetchData();\n//   }, [settings]);\n//   const changeData =  ({ results }) => setData(results);\n//   const fetchData = () => {\n//     const { searchQuery, sorting, page } = settings;\n//     if (searchQuery) {\n//       API.getMovieByQuery(page, searchQuery).then(changeData);\n//     } else {\n//       const requestFunc = REQUEST_MAP[sorting];\n//       if (requestFunc) {\n//         requestFunc(page).then(changeData);\n//       }\n//     }\n//   }\n//   const changeSettings = (update = {}) => {\n//     setSettings(prevState => ({\n//       ...prevState,\n//       page: 1,\n//       ...update\n//     }));\n//   }\n//   const onChange = searchQuery => {\n//     changeSettings({ searchQuery });\n//   };\n//   const onChangeDebounced = debounce(onChange, 400);\n//   const onTextChange = e => {\n//     setTempSearchQuery(e.target.value);\n//     onChangeDebounced(e.target.value);\n//   }\n//   const onSelectChange = e => {\n//     localStorage.setItem('sorting', e.target.value);\n//     changeSettings({ sorting: e.target.value })\n//   }\n//   return (\n//     <div className=\"Catalog\">\n//       <div className=\"filters\">\n//         <TextField\n//           label=\"Search\"\n//           value={tempSearchQuery}\n//           onChange={onTextChange}\n//         />\n//         <Select\n//           disabled={!!settings.searchQuery}\n//           onChange={onSelectChange}\n//           value={settings.sorting}\n//         >\n//           <MenuItem value=\"trending\">\n//             trending\n//           </MenuItem>\n//           <MenuItem value=\"popular\">\n//             popular\n//           </MenuItem>\n//           <MenuItem value=\"top\">\n//             top\n//           </MenuItem>\n//         </Select>\n//       </div>\n//       <div className=\"list\">\n//         {\n//           data.map(movie => (\n//             <ListItem\n//               movie={movie}\n//               key={movie.id}\n//               history={props.history}\n//             />\n//           ))\n//         }\n//       </div>\n//     </div>\n//   );\n// }\n\nconst TRENDING = 'trending';\nconst POPULAR = 'popular';\nconst TOP = 'top';\nconst REQUEST_MAP = {\n  [TRENDING]: API.getTrending,\n  [POPULAR]: API.getPopular,\n  [TOP]: API.getTopRated\n};\n\nfunction Catalog(props) {\n  ;\n\n  const _useState = useState([]),\n        _useState2 = _slicedToArray(_useState, 2),\n        data = _useState2[0],\n        setData = _useState2[1];\n\n  const _useState3 = useState({\n    sorting: localStorage.getItem('sorting') || 'trending',\n    page: localStorage.getItem('page') || 1,\n    searchQuery: ''\n  }),\n        _useState4 = _slicedToArray(_useState3, 2),\n        settings = _useState4[0],\n        setSettings = _useState4[1];\n\n  const changeSettings = (newSettings = {}) => {\n    console.log(newSettings.searchQuery);\n    setSettings(prevSettings => _objectSpread({}, prevSettings, {\n      page: 1\n    }, newSettings));\n  };\n\n  useEffect(() => {\n    localStorage.setItem('page', settings.page);\n    fetchData();\n  }, [settings]);\n\n  const changeData = ({\n    results\n  }) => setData(results);\n\n  const fetchData = () => {\n    const searchQuery = settings.searchQuery,\n          sorting = settings.sorting,\n          page = settings.page;\n\n    if (searchQuery) {\n      API.getMovieByQuery(page, searchQuery).then(changeData);\n    } else {\n      const requestFunc = REQUEST_MAP[sorting];\n\n      if (requestFunc) {\n        requestFunc(page).then(changeData);\n      }\n    }\n  };\n\n  return React.createElement(\"div\", {\n    className: \"Catalog\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161\n    },\n    __self: this\n  }, React.createElement(Filters, {\n    settings: settings,\n    changeSettings: changeSettings,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"list\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, data.map(movie => React.createElement(ListItem, {\n    movie: movie,\n    key: movie.id,\n    history: props.history,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169\n    },\n    __self: this\n  }))));\n}\n\nexport default Catalog;","map":{"version":3,"sources":["C:/prog/eleksPractice/moviesapp/src/components/Catalog.js"],"names":["debounce","React","useEffect","useState","API","Filters","TextField","Select","ListItem","TRENDING","POPULAR","TOP","REQUEST_MAP","getTrending","getPopular","getTopRated","Catalog","props","data","setData","sorting","localStorage","getItem","page","searchQuery","settings","setSettings","changeSettings","newSettings","console","log","prevSettings","setItem","fetchData","changeData","results","getMovieByQuery","then","requestFunc","map","movie","id","history"],"mappings":"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","sourcesContent":["import debounce from 'lodash/debounce'\r\nimport React, { useEffect, useState } from 'react';\r\nimport API from '../API'\r\nimport Filters from './Filters'\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Select from '@material-ui/core/Select';\r\nimport ListItem from './ListItem';\r\n\r\n// const TRENDING = 'trending';\r\n// const POPULAR = 'popular';\r\n// const TOP = 'top';\r\n\r\n// const REQUEST_MAP = {\r\n//   [TRENDING]: API.getTrending,\r\n//   [POPULAR]: API.getPopular,\r\n//   [TOP]: API.getTopRated\r\n// }\r\n\r\n// function Catalog(props) {\r\n//   const [tempSearchQuery, setTempSearchQuery] = useState('');\r\n//   const [data, setData] = useState([]);\r\n//   const [settings, setSettings] = useState({\r\n//     sorting: localStorage.getItem('sorting') || 'trending',\r\n//     page: localStorage.getItem('page') || 1,\r\n//     searchQuery: ''\r\n//   });\r\n\r\n//   useEffect((_prevProps, _prevState) => {\r\n//     localStorage.setItem('page', settings.page);\r\n//     fetchData();\r\n//   }, [settings]);\r\n\r\n//   const changeData =  ({ results }) => setData(results);\r\n\r\n//   const fetchData = () => {\r\n//     const { searchQuery, sorting, page } = settings;\r\n\r\n//     if (searchQuery) {\r\n//       API.getMovieByQuery(page, searchQuery).then(changeData);\r\n//     } else {\r\n//       const requestFunc = REQUEST_MAP[sorting];\r\n\r\n//       if (requestFunc) {\r\n//         requestFunc(page).then(changeData);\r\n//       }\r\n//     }\r\n//   }\r\n\r\n//   const changeSettings = (update = {}) => {\r\n//     setSettings(prevState => ({\r\n//       ...prevState,\r\n//       page: 1,\r\n//       ...update\r\n//     }));\r\n//   }\r\n\r\n//   const onChange = searchQuery => {\r\n//     changeSettings({ searchQuery });\r\n//   };\r\n\r\n//   const onChangeDebounced = debounce(onChange, 400);\r\n\r\n//   const onTextChange = e => {\r\n//     setTempSearchQuery(e.target.value);\r\n//     onChangeDebounced(e.target.value);\r\n//   }\r\n\r\n//   const onSelectChange = e => {\r\n//     localStorage.setItem('sorting', e.target.value);\r\n//     changeSettings({ sorting: e.target.value })\r\n//   }\r\n\r\n//   return (\r\n//     <div className=\"Catalog\">\r\n//       <div className=\"filters\">\r\n//         <TextField\r\n//           label=\"Search\"\r\n//           value={tempSearchQuery}\r\n//           onChange={onTextChange}\r\n//         />\r\n//         <Select\r\n//           disabled={!!settings.searchQuery}\r\n//           onChange={onSelectChange}\r\n//           value={settings.sorting}\r\n//         >\r\n//           <MenuItem value=\"trending\">\r\n//             trending\r\n//           </MenuItem>\r\n//           <MenuItem value=\"popular\">\r\n//             popular\r\n//           </MenuItem>\r\n//           <MenuItem value=\"top\">\r\n//             top\r\n//           </MenuItem>\r\n//         </Select>\r\n//       </div>\r\n//       <div className=\"list\">\r\n//         {\r\n//           data.map(movie => (\r\n//             <ListItem\r\n//               movie={movie}\r\n//               key={movie.id}\r\n//               history={props.history}\r\n//             />\r\n//           ))\r\n//         }\r\n//       </div>\r\n//     </div>\r\n//   );\r\n// }\r\n\r\nconst TRENDING = 'trending';\r\nconst POPULAR = 'popular';\r\nconst TOP = 'top';\r\n\r\nconst REQUEST_MAP = {\r\n  [TRENDING]: API.getTrending,\r\n  [POPULAR]: API.getPopular,\r\n  [TOP]: API.getTopRated\r\n}\r\n\r\nfunction Catalog(props) {;\r\n  const [data, setData] = useState([]);\r\n  const [settings, setSettings] = useState({\r\n    sorting: localStorage.getItem('sorting') || 'trending',\r\n    page: localStorage.getItem('page') || 1,\r\n    searchQuery: ''\r\n  });\r\n\r\n  const changeSettings = (newSettings = {}) => {\r\n    console.log(newSettings.searchQuery);\r\n    setSettings(prevSettings => ({\r\n      ...prevSettings,\r\n      page: 1,\r\n      ...newSettings\r\n    }));\r\n  }\r\n\r\n  useEffect(() => {\r\n    localStorage.setItem('page', settings.page);\r\n    fetchData();\r\n  }, [settings]);\r\n\r\n  const changeData =  ({ results }) => setData(results);\r\n\r\n  const fetchData = () => {\r\n    const { searchQuery, sorting, page } = settings;\r\n\r\n    if (searchQuery) {\r\n      API.getMovieByQuery(page, searchQuery).then(changeData);\r\n    } else {\r\n      const requestFunc = REQUEST_MAP[sorting];\r\n\r\n      if (requestFunc) {\r\n        requestFunc(page).then(changeData);\r\n      }\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"Catalog\">\r\n      <Filters \r\n        settings={settings} \r\n        changeSettings={changeSettings}\r\n      />\r\n      <div className=\"list\">\r\n        {\r\n          data.map(movie => (\r\n            <ListItem\r\n              movie={movie}\r\n              key={movie.id}\r\n              history={props.history}\r\n            />\r\n          ))\r\n        }\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Catalog;\r\n"]},"metadata":{},"sourceType":"module"}