{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\INTERN\\\\Documents\\\\Practice\\\\eleksPractice\\\\moviesapp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"C:\\\\Users\\\\INTERN\\\\Documents\\\\Practice\\\\eleksPractice\\\\moviesapp\\\\src\\\\components\\\\Catalog.js\";\nimport debounce from 'lodash/debounce';\nimport React from 'react';\nimport API from '../API';\nimport './styles/Catalog.css';\nimport TextField from '@material-ui/core/TextField';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport ListItem from './ListItem';\nconst TRENDING = 'trending';\nconst POPULAR = 'popular';\nconst TOP = 'top';\nconst REQUEST_MAP = {\n  [TRENDING]: API.getTrending,\n  [POPULAR]: API.getPopular,\n  [TOP]: API.getTopRated\n};\n\nclass Catalog extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      settings: {\n        sorting: localStorage.getItem('sorting') || 'trending',\n        page: localStorage.getItem('page') || 1,\n        searchQuery: ''\n      },\n      data: []\n    };\n\n    this.changeData = ({\n      results\n    }) => {\n      this.setState({\n        data: results\n      });\n    };\n\n    this.changeSettings = (update = {}) => {\n      this.setState(prevState => ({\n        settings: _objectSpread({}, prevState.settings, {\n          page: 1\n        }, update)\n      }));\n    };\n\n    this.onChange = e => {\n      this.changeSettings({\n        searchQuery: e.target.value\n      });\n    };\n\n    this.onChangeDebounced = debounce(this.onChange, 3000);\n\n    this.fetchData = () => {\n      const _this$state$settings = this.state.settings,\n            searchQuery = _this$state$settings.searchQuery,\n            sorting = _this$state$settings.sorting,\n            page = _this$state$settings.page;\n\n      if (searchQuery) {\n        API.getMovieByQuery(page, searchQuery).then(this.changeData);\n      } else {\n        const requestFunc = REQUEST_MAP[sorting];\n\n        if (requestFunc) {\n          requestFunc(page).then(this.changeData);\n        }\n      }\n    };\n\n    this.onSelectChange = e => {\n      localStorage.setItem('sorting', e.target.value);\n      this.changeSettings({\n        sorting: e.target.value\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.fetchData();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (this.state.settings !== prevState.settings) {\n      this.fetchData();\n    }\n  }\n\n  render() {\n    const _this$state = this.state,\n          data = _this$state.data,\n          _this$state$settings2 = _this$state.settings,\n          searchQuery = _this$state$settings2.searchQuery,\n          sorting = _this$state$settings2.sorting;\n    return React.createElement(\"div\", {\n      className: \"Catalog\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"filters\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, React.createElement(TextField, {\n      label: \"Search\",\n      defaultValue: searchQuery,\n      onChange: this.onChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }), React.createElement(Select, {\n      disabled: !!searchQuery,\n      onChange: this.onSelectChange,\n      value: sorting,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, React.createElement(MenuItem, {\n      value: \"trending\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, \"trending\"), React.createElement(MenuItem, {\n      value: \"popular\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, \"popular\"), React.createElement(MenuItem, {\n      value: \"top\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, \"top\"))), React.createElement(\"div\", {\n      className: \"list\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, data.map(movie => React.createElement(ListItem, {\n      movie: movie,\n      key: movie.id,\n      history: this.props.history,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nexport default Catalog;","map":{"version":3,"sources":["C:/Users/INTERN/Documents/Practice/eleksPractice/moviesapp/src/components/Catalog.js"],"names":["debounce","React","API","TextField","Select","MenuItem","ListItem","TRENDING","POPULAR","TOP","REQUEST_MAP","getTrending","getPopular","getTopRated","Catalog","Component","state","settings","sorting","localStorage","getItem","page","searchQuery","data","changeData","results","setState","changeSettings","update","prevState","onChange","e","target","value","onChangeDebounced","fetchData","getMovieByQuery","then","requestFunc","onSelectChange","setItem","componentDidMount","componentDidUpdate","prevProps","render","map","movie","id","props","history"],"mappings":"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","sourcesContent":["import debounce from 'lodash/debounce'\r\nimport React from 'react';\r\nimport API from '../API'\r\nimport './styles/Catalog.css';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Select from '@material-ui/core/Select';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport ListItem from './ListItem';\r\n\r\nconst TRENDING = 'trending';\r\nconst POPULAR = 'popular';\r\nconst TOP = 'top';\r\n\r\nconst REQUEST_MAP = {\r\n  [TRENDING]: API.getTrending,\r\n  [POPULAR]: API.getPopular,\r\n  [TOP]: API.getTopRated\r\n}\r\n\r\nclass Catalog extends React.Component {\r\n  state = {\r\n    settings: {\r\n      sorting: localStorage.getItem('sorting') || 'trending',\r\n      page: localStorage.getItem('page') || 1,\r\n      searchQuery: ''\r\n    },\r\n    data: []\r\n  };\r\n\r\n  componentDidMount () {\r\n    this.fetchData();\r\n  }\r\n\r\n  componentDidUpdate (prevProps, prevState) {\r\n    if (this.state.settings !== prevState.settings) {\r\n      this.fetchData();\r\n    }\r\n  }\r\n\r\n  changeData = ({ results }) => {\r\n    this.setState({ data: results });\r\n  }\r\n\r\n  changeSettings = (update = {}) => {\r\n    this.setState(prevState => ({\r\n      settings: {\r\n        ...prevState.settings,\r\n        page: 1,\r\n        ...update\r\n      }\r\n    }))\r\n  }\r\n\r\n  onChange = e => {\r\n    this.changeSettings({ searchQuery: e.target.value  });\r\n  };\r\n\r\n  onChangeDebounced = debounce(this.onChange, 3000);\r\n\r\n  fetchData = () => {\r\n    const { searchQuery, sorting, page } = this.state.settings;\r\n\r\n    if (searchQuery) {\r\n      API.getMovieByQuery(page, searchQuery).then(this.changeData);\r\n    } else {\r\n      const requestFunc = REQUEST_MAP[sorting];\r\n\r\n      if (requestFunc) {\r\n        requestFunc(page).then(this.changeData);\r\n      }\r\n    }\r\n  }\r\n\r\n  onSelectChange = e => {\r\n    localStorage.setItem('sorting', e.target.value);\r\n    this.changeSettings({ sorting: e.target.value })\r\n  }\r\n\r\n  render() {\r\n    const { data, settings: { searchQuery, sorting } } = this.state;\r\n\r\n    return (\r\n      <div className=\"Catalog\">\r\n        <div className=\"filters\">\r\n          <TextField\r\n            label=\"Search\"\r\n            defaultValue={searchQuery}\r\n            onChange={this.onChange}\r\n          />\r\n          <Select\r\n            disabled={!!searchQuery}\r\n            onChange={this.onSelectChange}\r\n            value={sorting}\r\n          >\r\n            <MenuItem value=\"trending\">\r\n              trending\r\n            </MenuItem>\r\n            <MenuItem value=\"popular\">\r\n              popular\r\n            </MenuItem>\r\n            <MenuItem value=\"top\">\r\n              top\r\n            </MenuItem>\r\n          </Select>\r\n        </div>\r\n        <div className=\"list\">\r\n          {\r\n            data.map(movie => (\r\n              <ListItem\r\n                movie={movie}\r\n                key={movie.id}\r\n                history={this.props.history}\r\n              />\r\n            ))\r\n          }\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Catalog;\r\n"]},"metadata":{},"sourceType":"module"}