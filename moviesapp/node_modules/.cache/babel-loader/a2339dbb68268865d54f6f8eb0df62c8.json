{"ast":null,"code":"import _objectSpread from \"C:\\\\prog\\\\eleksPractice\\\\moviesapp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"C:\\\\prog\\\\eleksPractice\\\\moviesapp\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\prog\\\\eleksPractice\\\\moviesapp\\\\src\\\\components\\\\App.js\";\nimport React, { useState, useCallback, useEffect } from 'react';\nimport './styles/App.css';\nimport API from '../API';\nimport Catalog from './Catalog';\nimport CatalogItem from './CatalogItem';\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom';\nconst TRENDING = 'trending';\nconst POPULAR = 'popular';\nconst TOP = 'top';\nconst SEARCH = 'search';\nconst REQUEST_MAP = {\n  [TRENDING]: API.getTrending,\n  [POPULAR]: API.getPopular,\n  [TOP]: API.getTopRated,\n  [SEARCH]: API.getMovieByQuery\n};\n\nfunction App() {\n  const _useState = useState([]),\n        _useState2 = _slicedToArray(_useState, 2),\n        data = _useState2[0],\n        setData = _useState2[1];\n\n  const _useState3 = useState({}),\n        _useState4 = _slicedToArray(_useState3, 2),\n        dataById = _useState4[0],\n        setDataById = _useState4[1];\n\n  const _useState5 = useState(0),\n        _useState6 = _slicedToArray(_useState5, 2),\n        totalPages = _useState6[0],\n        setTotalPages = _useState6[1];\n\n  const _useState7 = useState({\n    sorting: localStorage.getItem('sorting') || 'trending',\n    page: localStorage.getItem('page') || 1,\n    searchQuery: ''\n  }),\n        _useState8 = _slicedToArray(_useState7, 2),\n        settings = _useState8[0],\n        setSettings = _useState8[1];\n\n  useEffect(() => {\n    const searchQuery = settings.searchQuery,\n          sorting = settings.sorting,\n          page = settings.page;\n    const requstFuncKey = searchQuery.trim() ? SEARCH : sorting;\n    const requestFunc = REQUEST_MAP[requstFuncKey];\n    localStorage.setItem('page', page);\n    localStorage.setItem('sorting', sorting);\n    requestFunc(settings).then(({\n      total_pages,\n      results\n    }) => {\n      setData(results);\n      setTotalPages(total_pages);\n      const additionalDataById = results.reduce((res, curr) => {\n        res[curr.id] = curr;\n        return res;\n      }, {});\n      setDataById(_objectSpread({}, dataById, {}, additionalDataById));\n    });\n  }, [settings]);\n  return React.createElement(\"div\", {\n    className: \"App\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60\n    },\n    __self: this\n  }, React.createElement(Router, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  }, React.createElement(Switch, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, React.createElement(Route, {\n    path: \"/catalog\",\n    exact: true,\n    render: routerProps => React.createElement(Catalog, Object.assign({}, routerProps, {\n      data: data,\n      dataById: dataById,\n      settings: settings,\n      setSettings: setSettings,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  }), React.createElement(Route, {\n    path: \"/catalog/:id\",\n    render: routerProps => React.createElement(CatalogItem, Object.assign({}, routerProps, {\n      dataById: dataById,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }))));\n}\n\nexport default App;","map":{"version":3,"sources":["C:/prog/eleksPractice/moviesapp/src/components/App.js"],"names":["React","useState","useCallback","useEffect","API","Catalog","CatalogItem","BrowserRouter","Router","Route","Switch","TRENDING","POPULAR","TOP","SEARCH","REQUEST_MAP","getTrending","getPopular","getTopRated","getMovieByQuery","App","data","setData","dataById","setDataById","totalPages","setTotalPages","sorting","localStorage","getItem","page","searchQuery","settings","setSettings","requstFuncKey","trim","requestFunc","setItem","then","total_pages","results","additionalDataById","reduce","res","curr","id","routerProps"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, useEffect } from 'react';\r\nimport './styles/App.css';\r\nimport API from '../API'\r\nimport Catalog from './Catalog';\r\nimport CatalogItem from './CatalogItem';\r\nimport {\r\n  BrowserRouter as Router,\r\n  Route,\r\n  Switch\r\n} from 'react-router-dom';\r\n\r\nconst TRENDING = 'trending';\r\nconst POPULAR = 'popular';\r\nconst TOP = 'top';\r\nconst SEARCH = 'search';\r\n\r\nconst REQUEST_MAP = {\r\n  [TRENDING]: API.getTrending,\r\n  [POPULAR]: API.getPopular,\r\n  [TOP]: API.getTopRated,\r\n  [SEARCH]: API.getMovieByQuery\r\n}\r\n\r\nfunction App() {\r\n  const [data, setData] = useState([]);\r\n  const [dataById, setDataById] = useState({});\r\n  const [totalPages , setTotalPages] = useState(0);\r\n  const [settings, setSettings] = useState({\r\n    sorting: localStorage.getItem('sorting') || 'trending',\r\n    page: localStorage.getItem('page') || 1,\r\n    searchQuery: ''\r\n  });\r\n\r\n  useEffect(() => {\r\n    const { searchQuery, sorting, page } = settings;\r\n    const requstFuncKey = searchQuery.trim() ? SEARCH : sorting;\r\n    const requestFunc = REQUEST_MAP[requstFuncKey];\r\n\r\n    localStorage.setItem('page', page);\r\n    localStorage.setItem('sorting', sorting);\r\n\r\n    requestFunc(settings)\r\n    .then(({total_pages, results}) => {\r\n      setData(results);\r\n      setTotalPages(total_pages);\r\n\r\n      const additionalDataById = results.reduce((res, curr) => {\r\n        res[curr.id] = curr;\r\n        return res;\r\n      }, {});\r\n\r\n      setDataById({\r\n        ...dataById,\r\n        ...additionalDataById\r\n      });\r\n    })\r\n  }, [settings]);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <Router>\r\n        <Switch>\r\n            <Route\r\n              path='/catalog'\r\n              exact\r\n              render={(routerProps) => (\r\n                <Catalog\r\n                  {...routerProps}\r\n                  data={data}\r\n                  dataById={dataById}\r\n                  settings={settings}\r\n                  setSettings={setSettings}\r\n                />\r\n              )}\r\n            />\r\n            <Route\r\n              path='/catalog/:id'\r\n              render={(routerProps) => <CatalogItem {...routerProps} dataById={dataById} />}\r\n            />\r\n        </Switch>\r\n      </Router>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}